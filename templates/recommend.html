{% extends 'layout.html' %}

{% block body %}

<script>
function play(p1) {
  // window.alert(p1)
  // var url = p1;
  document.getElementById("iframe").src = p1  // Change url of widget
}    
</script>

<script type=text/javascript>
function loadID() {
  document.getElementById("add_user_txt").innerHTML = "User ID: " + localStorage.getItem("USERID");
}    
</script>

<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<h2> 
  Recommendations 
  <span style="float:right;"> 
    <p id="add_user_txt"></p>
  </span> 
</h2>

<div class="w3-container" style="width:100%; height:475px; overflow:auto;">
  <table class="w3-table-all w3-hoverable">
    <thead>
      <tr class="w3-gray">
        <th width="30%">Rank</th>
        <th width="30%">Song</th>
        <th width="30%">Score</th>
        <th width="10%">Select</th> 
      </tr>
    </thead>
    {% for i, row in pm.iterrows() %}
      <tr> 
        <td>{{ row['Rank']|int  }}</td>
        <td>{{ row['title'] }}</td>
        <td>{{ row['score'] }}</td>
        <td> 
          <button class="w3-button w3-round w3-small w3-blue" onclick="play('{{df.loc[df['title'] == row['title'], 'url_link'].iloc[0] }}!')">Select</button>
        </td>
      </tr>
    {% endfor %}
  </table>
</div>

<div class="footer">
<iframe onload="loadID()" width="80%" height="125" scrolling="no" frameborder="no" src='https://w.soundcloud.com/player/?url=https%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F441888573&show_artwork=true&client_id=93e33e327fd8a9b77becd179652272e2%27' id="iframe"></iframe>
<script src="https://w.soundcloud.com/player/api.js" type="text/javascript"></script>
  <script type="text/javascript">
  (function(){
  var widgetIframe = document.getElementById('sc-widget'),
  widget       = SC.Widget(widgetIframe),
  newSoundUrl = 'http://api.soundcloud.com/tracks/441456084';

  widget.bind(SC.Widget.Events.READY, function() {
    // load new widget
    widget.bind(SC.Widget.Events.FINISH, function() {
        widget.load(newSoundUrl, {
          show_artwork: false
        });   
      });
    });
  }());
  </script>
</div>

{% endblock %}
